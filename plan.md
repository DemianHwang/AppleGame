# plan.md — 사과 게임 (Fruit Box) 원본 규칙 스펙

## 1. 게임 목적

- 숫자가 적힌 사과(과일) 블록을 선택하여
- **선택 영역 안 숫자의 합이 정확히 10이 되도록 만들어 제거**
- 제한 시간 안에 **최대 점수 획득**이 목표

---

## 2. 게임 필드

### 보드 구조

- **고정 크기 격자(Grid) 보드**
- 보드 크기:
  - 가로: ORIGINAL_WIDTH (17)
  - 세로: ORIGINAL_HEIGHT (10)
- 게임 시작 시 보드 크기는 고정되며 플레이 중 변경되지 않음

### 블록 구성

- 각 칸에는 **1 ~ 9 사이 숫자가 표시된 사과 블록**이 배치됨
- 모든 칸은 게임 시작 시 숫자로 채워져 있음

---

## 3. 입력 방식

- 플레이어는 **마우스 또는 터치로 드래그하여 영역 선택**
- 선택 영역은:
  - 드래그 시작 좌표부터 종료 좌표까지의
  - **직사각형 범위(Rectangle Selection)**

---

## 4. 제거 규칙

- 선택한 직사각형 영역 내부의 모든 숫자의 합이
  - **정확히 10일 때만 제거 가능**
- 합이 10이 아닐 경우:
  - 제거 발생 없음
  - 점수 변화 없음

---

## 5. 제거 결과 처리

- 제거된 칸은 **빈 칸(Empty)** 상태로 변경됨

### 중요한 제약

- 블록 낙하(중력) 없음
- 블록 자동 이동 없음
- 빈 칸 재정렬 없음
- 자동 채우기 없음

→ 제거 이후 보드 상태는 **그대로 유지**

---

## 6. 점수 시스템

- 제거된 **블록 1개당 1점**
- 추가 배율, 콤보 시스템 없음
- 보너스 규칙 없음

---

## 7. 제한 조건

### 시간 제한

- 게임은 **타임어택 방식**
- 제한 시간: ORIGINAL_TIME_LIMIT (120) 초
- 시간 종료 시 즉시 게임 종료

---

## 8. 게임 종료 조건

- 제한 시간 종료 시 게임 종료
- 또는 제한 시간 이전 모든 블록 제거시

---

## 9. UI 필수 표시 요소

- 현재 점수
- 남은 시간
- 선택 중인 영역 표시
- 선택 영역 숫자 합 표시

---

## 10. 결과 화면

- 게임 종료 후:
  - 최종 점수 표시
  - 다시 시작 버튼 제공

---

## 11. 힌트 시스템

### 힌트 표시 조건

- **5초 무활동 시 자동 표시**
  - 마지막 사용자 행동(마우스 이벤트)으로부터 5초 경과
  - 합이 10이 되는 영역을 파란색 박스로 표시

### 힌트 우선순위

1. **최우선**: 인접한 2개 블록
   - 가로 또는 세로로 붙어있는 2개
   - 예: [1][9], [3][7], [4][6]

2. **중간**: 작은 인접 영역
   - 2x2, 2x3 등 작은 직사각형
   - 블록 개수 3~6개

3. **최하위**: 큰 영역 또는 떨어진 블록
   - 블록 개수 7개 이상

### 힌트 동작 규칙

- **힌트 표시 중**:
  - 타이머는 작동하지 않음
  - 힌트는 사용자가 해당 영역을 맞출 때까지 계속 유지
  - 다른 영역을 시도해도 힌트는 유지

- **힌트 제거 조건**:
  - 사용자가 힌트 영역을 정확히 선택하여 성공했을 때만 제거
  - 제거 후 5초 뒤 새로운 힌트 표시

### 힌트 시각 디자인

- **배경색**: 파란색 (#2196f3)
- **투명도**: 25%
- **테두리**: 3px 점선 [10, 5]
- 사용자 선택 영역(녹색/빨간색 실선)과 명확히 구분

---

## 12. 파티클 효과

### 블록 제거 효과

- **발생 조건**: 블록 제거 성공 시
- **파티클 모양**: 별 ⭐ (이모지)
- **파티클 개수**: 블록당 3~5개 (랜덤)
- **파티클 크기**: 3~8px (랜덤)

### 애니메이션 동작

- **폭발**: 랜덤 방향으로 초기 속도
- **중력**: 아래로 떨어지는 효과
- **감속**: 점차 속도 감소
- **페이드아웃**: 0.5~1초 동안 투명도 감소
- **제거**: 수명 종료 시 자동 제거

### 성능 최적화

- 최대 파티클 개수 제한: 200개
- requestAnimationFrame 사용

---

## 13. 콤보 시스템

### 콤보 동작

- 블록 제거 성공 시 콤보 카운트 증가
- 콤보는 **점수에 영향을 주지 않음** (블록당 1점 고정)
- 콤보는 **사운드 효과로만 표현** (시각적 표시 없음)

### 사운드 효과

- 콤보가 이어질수록 성공 사운드의 음높이가 한음씩 상승
- 1 콤보 (첫 성공): 기본 음높이 (C5, E5, G5)
- 2 콤보: 한음 올림 (D5, F#5, A5)
- 3 콤보: 두음 올림 (E5, G#5, B5)
- 이후 계속 상승
- **최대 12 콤보까지** (그 이후는 최고 음높이 유지)

### 콤보 리셋 조건

- 합이 10이 아닌 영역 선택 시 (실패)
- 5초 무활동 후 힌트가 표시될 때
- 게임 시작 또는 재시작 시

---

## 14. 금지 규칙 (절대 추가 금지)

명시된 지시 사항만 따르고 추측해서 새로운 기능을 넣지 않는다.

### 특별 금지 항목

- **일시정지 기능 금지**: 타이머를 멈추는 것은 어뷰징 가능
- **콤보 점수 배율 금지**: 블록 아껴두기 메타게임 방지


